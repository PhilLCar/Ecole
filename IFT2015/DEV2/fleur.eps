/T:x 200.0 def
/T:y 100.0 def
/T:a 90.0 def

/T:draw % dessine une arrête
{
	T:x T:y moveto T:step
	T:x T:y lineto stroke
} def

/T:step % avance la tortue d'un pas
{
	/T:x T:a cos 4.0 mul T:x add def
	/T:y T:a sin 4.0 mul T:y add def
} def

/open % sauvegarde l'état
{
	3 dict begin
} def

/plus % tourne la tortue CCW
{
	/T:a T:a 10.0 add def
} def

/minus % tourne la tortue CW
{
	/T:a T:a 10.0 sub def
} def

/F % Règle d'expansion de F
{
	dup 0 eq
	{
		T:draw
		pop
	}{
		1 sub
		rand 4 mod
		dup 3 eq {
			pop dup F open plus dup F end minus F 
		}{
			dup 2 eq {
				pop dup F open minus dup F end plus F 
			}{
				dup 1 eq {
					pop dup F F 
				}{
					pop dup F open plus plus dup F end open minus minus dup F end F 
				} ifelse
			} ifelse
		} ifelse
	} ifelse
} def

/f % Règle d'expansion de f
{
	dup 0 eq
	{
		T:step
		pop
	}{
		1 sub
	} ifelse
} def

7
F 
